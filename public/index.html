<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>BUNCA HACCP ¬∑ Shops</title>
  <link rel="stylesheet" href="/assets/styles.css"/>
  <meta name="theme-color" content="#10b981"/>
</head>
<body>
  <header class="header">
    <div class="wrap">
      <div class="brand"><span class="dot"></span><span>BUNCA HACCP</span></div>
      <button id="menuToggle" class="menu-btn" aria-label="Menu"><span></span></button>
      <nav id="mainNav" class="nav">
        <a class="active" href="/">Home</a>
        <a href="/admin">Admin</a>
        <a href="/login">Login</a>
      </nav>
    </div>
  </header>

  <main class="container">
    <section class="hero">
      <h1>Shops</h1>
      <p class="muted">Open a shop to perform the daily check or view the history.</p>
    </section>

    <section class="grid cols-3" id="shopsGrid"></section>
  </main>

  <button id="fab" class="fab">‚â°</button>
  <div id="fabMenu" class="fab-menu">
    <a href="/">üè† Home</a>
    <a href="/admin">üõ† Admin</a>
    <a href="/login">üîê Login</a>
  </div>

  <footer>¬© BUNCA HACCP</footer>

  <script src="/assets/helpers.js"></script>
  <script>
    function card(s){
      const cls = s.status==='open'?'badge':'badge warn';
      return `<article class="card">
        <div style="display:grid;gap:10px">
          ${s.image_url ? `<img src="${s.image_url}" alt="${s.name}" style="border-radius:12px;height:160px;object-fit:cover">` : ''}
          <h3 class="card-title">${s.name}</h3>
          <span class="${cls}">${s.status}</span>
          <p class="muted">${s.description || ''}</p>
          <div class="row cols-2">
            <a class="btn primary" href="/shop/${encodeURIComponent(s.slug)}">Open</a>
            <a class="btn" href="/history/${encodeURIComponent(s.slug)}">History</a>
          </div>
        </div>
      </article>`;
    }
    (async ()=>{
      const r = await fetch('/api/shops'); const d = await r.json();
      const grid = document.getElementById('shopsGrid');
      grid.innerHTML = (d.shops||[]).map(card).join('') || `
        <div class="card"><h3 class="card-title">No shops yet</h3>
        <p class="muted">Login as admin and add your first shop in <a href="/admin">Admin</a>.</p></div>`;
    })();
  </script>
</body>
</html>
